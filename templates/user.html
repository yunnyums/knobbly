{% extends "layout.html" %}

{% block titulo %}
¬°Hola, {{ current_user.nombre }}! üêæ
{% endblock %}

{% block contenido %}

<style>

/* ====== ESTILO NIVEL DIOS ====== */

body {
  background: linear-gradient(135deg, #f3e8ff, #fff);
  animation: fadeIn 1s ease-out;
}

/* NAVBAR */
.navbar-custom {
  background: linear-gradient(90deg, #7b2cbf, #9d4edd);
  box-shadow: 0 4px 16px rgba(0,0,0,0.15);
}
.navbar-custom .nav-link,
.navbar-custom .navbar-brand {
  color: white !important;
  font-weight: 600;
}

/* ===== CARDS ===== */

.card-cat {
  border: none;
  border-radius: 18px;
  overflow: hidden;
  background: white;
  box-shadow: 0 8px 20px rgba(0,0,0,0.12);
  transition: transform .2s ease, box-shadow .2s ease;
  transform-style: preserve-3d;
  perspective: 1000px;
  cursor: pointer;
}

/* Tilt suave */
.card-cat:hover {
  box-shadow: 0 12px 28px rgba(0,0,0,0.18);
  transform: rotateX(6deg) rotateY(-6deg);
}

/* Imagen completa */
.card-cat img {
  width: 100%;
  height: 350px;
  object-fit: cover; /* Ya no recorta, muestra toda la imagen */
}

/* Info */
.cat-info {
  padding: 1rem;
  text-align: center;
}
.cat-name {
  font-size: 1.6rem;
  font-weight: bold;
  color: #343a40;
}
.cat-desc {
  color: #6c757d;
}

/* Coraz√≥n */
.like-btn {
  font-size: 1.8rem;
  cursor: pointer;
  user-select: none;
  transition: transform .2s ease;
}

.like-btn.liked {
  color: #ff3860;
  transform: scale(1.45);
}

.like-btn:not(.liked) {
  color: #bbb;
}

/* Coraz√≥n explosi√≥n */
.heart-burst {
  position: absolute;
  font-size: 2rem;
  color: #ff3860;
  animation: burst .45s ease forwards;
}

@keyframes burst {
  0% { transform: scale(.2); opacity: 1; }
  80% { transform: scale(1.7); opacity: .6; }
  100% { transform: scale(2); opacity: 0; }
}

/* Fade inicial */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

</style>

<!-- AUDIO DE MIAU -->
<audio id="miauSound" src="/static/miau.mp3"></audio>

<nav class="navbar navbar-expand-lg navbar-custom">
  <div class="container-fluid">
    <a class="navbar-brand" href="/">knobbly üê±</a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
      data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav me-auto">

        <li class="nav-item"><a class="nav-link" href="/productos">üõçÔ∏è Productos</a></li>
        <li class="nav-item"><a class="nav-link" href="/carrito">üõí Carrito</a></li>
        <li class="nav-item"><a class="nav-link" href="/mis_pedidos"><i class="fa-solid fa-box"></i> Mis pedidos</a></li>

      </ul>

      <ul class="navbar-nav">
        <li class="nav-item">
          <span class="navbar-text me-3">{{ current_user.nombre }}</span>
        </li>
        <li class="nav-item"><a class="nav-link" href="/signout">Cerrar sesi√≥n</a></li>
      </ul>

    </div>
  </div>
</nav>

<div class="container mt-4">
  <h2 class="text-center mb-4">üê± Perfiles de Gatitos</h2>

  <div class="row row-cols-1 row-cols-md-3 g-4">
    {% for g in gatos %}
    <div class="col">

      <div class="card-cat">

        <img src="https://cataas.com/cat?{{ g[0] }}"
             alt="{{ g[2] }}">

        <div class="cat-info">
          <div class="cat-name">{{ g[2] }}</div>
          <p class="cat-desc">{{ g[4] }}</p>
          <p><strong>Edad:</strong> {{ g[3] }} a√±os</p>
          <p>{{ g[5] }}</p>

          <div class="position-relative mt-2">
            <i class="fa-solid fa-heart like-btn" onclick="toggleLike(this)"></i>
          </div>
        </div>

      </div>

    </div>
    {% endfor %}
  </div>
</div>

<script>
const sonido = document.getElementById("miauSound");

function toggleLike(el) {
  el.classList.toggle("liked");

  if (el.classList.contains("liked")) {
    sonido.currentTime = 0;
    sonido.play();
  }

  const burst = document.createElement("div");
  burst.classList.add("heart-burst");
  burst.innerHTML = "‚ù§Ô∏è";
  el.parentElement.appendChild(burst);

  setTimeout(() => burst.remove(), 450);
}

/* Tilt 3D PRO */
document.querySelectorAll(".card-cat").forEach(card => {
  card.addEventListener("mousemove", e => {
    const rect = card.getBoundingClientRect();
    const x = e.clientX - rect.left - rect.width / 2;
    const y = e.clientY - rect.top - rect.height / 2;
    card.style.transform = `rotateX(${y / 25}deg) rotateY(${x / -25}deg)`;
  });

  card.addEventListener("mouseleave", () => {
    card.style.transform = "rotateX(0deg) rotateY(0deg)";
  });
});
</script>

{% endblock %}
